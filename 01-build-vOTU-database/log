# log for 01-build-vOTU-database

2023-11-16

Got the headers of each to compare which sets are in each vOTU cluster to see if we found new contigs with this analysis.

(base) [riddell26@owens-login04 data]$ grep ">" 20230407_Grantham_incubations_viral_contigs.fa > 20230407_contig_headers.txt
(base) [riddell26@owens-login04 data]$ grep ">" 2023-10-31-assemblies-final-viral-scored.fa > 20231031_contig_headers.txt
(base) [riddell26@owens-login04 data]$ grep ">" stordalen_vOTUs_symlink.fa > stordalen_vOTU_headers.txt

2023-11-14

Last night I was able to re-do the vs2-sop-screen step to extract the right
list of vOTUs from the old assemblies.

After that, I clustered with the checkV clustering program ANICLUST
at MIUViG cutoffs of 95% ani and 85% tcov. This resulted in 17343 vOTU clusters.

2023-11-13

Finished processing the viral contigs. I split the scaffolds.fa file into 10 pieces, all less
than 1Gb and it worked well.

I was having an issue where the vs2-sop-screen script was not giving me any fasta file.

I figured out it was because we are now pulling from the checkV combined.fna file instead of
the DRAMv fasta file, which was what the original was doing (and was wrong because it was vs2-SOP modded).

I can now cluster my sequences!

2023-11-10

Had to split the MAGS, scaffolds.fa, into multiple fasta files. It was too big and timing out
Ran on owens since someone is hogging most of the pitzer nodes.

2023-11-08

All samples finished successfully for vs2-pass1 except the MAG scaffolds. This was to be 
expected since it was 4x larger than the assemblies.

I re-ran the MAG scaffolds with 24 hrs instead of 12, and since it had already finished
step 1 I think it will finish by tomorrow. 

In the meantime, I'm going to run CheckV and vs2-pass2 on the next set. 

If those finish early, I'll run DRAMv as well.

2023-11-07

Ran all samples on vs2-pass1 since the first test was successful for arrayid=1.

I also ran CheckV on arrayid=1 and it was successful, so I started vs2-pass2
for arrayid=1 to make sure all the code is working.

So far we are covering both the MAG scaffolds and the assemblies.

The MAG scaffolds are large (8Gb) vs the assemblies (2Gb each) so there is a 
possibility the MAG scaffolds will time out, and if so I'll correct for that.

2023-11-06

Created symbolic links (soft links) between Adjie's stordalen vOTU database and the data directory.

Wrote out protocol for this directory.

Figured out which files Bridget sent go with which tar directory and updated the main README.

commands:

cp scaffolds_1kb_renamed.tar.gz /fs/scratch/Sullivan_Lab/
mkdir JamesR
mv scaffolds_1kb_renamed.tar.gz JamesR/
cd JamesR
tar -xvf scaffolds_1kb_renamed.tar.gz 

scaffolds_1kb_renamed/
scaffolds_1kb_renamed/STM_0716_E_M_E030_A.contigs_1kb.fa
scaffolds_1kb_renamed/STM_0716_E_M_E026_A.contigs_1kb.fa
scaffolds_1kb_renamed/STM_0716_E_M_E034_A.contigs_1kb.fa
scaffolds_1kb_renamed/STM_0716_E_M_E050_A.contigs_1kb.fa
scaffolds_1kb_renamed/STM_0716_E_M_E054_A.contigs_1kb.fa
scaffolds_1kb_renamed/STM_0716_E_M_E058_A.contigs_1kb.fa
scaffolds_1kb_renamed/STM_0716_E_M_E034_E058_A.contigs_1kb.fa
scaffolds_1kb_renamed/STM_0716_E_M_E026_E050_A.contigs_1kb.fa
scaffolds_1kb_renamed/STM_0716_E_M_E026_E050_E061_D.contigs_1kb.fa
scaffolds_1kb_renamed/STM_0716_E_M_E034_E058_E069_D.contigs_1kb.fa
scaffolds_1kb_renamed/STM_0716_E_M_E030_E054_E065_D.contigs_1kb.fa
scaffolds_1kb_renamed/STM_0716_E_M_E026_E050_E061_E.contigs_1kb.fa
scaffolds_1kb_renamed/STM_0716_E_M_E026_E030_E034_A.contigs_1kb.fa
scaffolds_1kb_renamed/STM_0716_E_M_E050_E054_E058_A.contigs_1kb.fa
scaffolds_1kb_renamed/STM_0716_E_M_E050_E054_E058_D.contigs_1kb.fa
scaffolds_1kb_renamed/STM_0716_E_M_E026_E030_E034_D.contigs_1kb.fa

Moved the MAG scaffolds (8Gb) into the new assemblies folder so that they can all be processed together

